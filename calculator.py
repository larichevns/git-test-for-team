def add(a, b):
    """–°–ª–æ–∂–µ–Ω–∏–µ"""
    return a + b

def subtract(a, b):
    """–í—ã—á–∏—Ç–∞–Ω–∏–µ"""
    return a - b

def multiply(a, b):
    """–£–º–Ω–æ–∂–µ–Ω–∏–µ"""
    return a * b

def divide(a, b):
    """–î–µ–ª–µ–Ω–∏–µ"""
    if b == 0:
        return "–û—à–∏–±–∫–∞: –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å"
    return a / b

def guess_gender_by_name(name):
    """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–µ–Ω–¥–µ—Ä–∞ –ø–æ –∏–º–µ–Ω–∏ (—Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏)"""
    import random

    # –†–∞–∑–ª–∏—á–Ω—ã–µ –≥–µ–Ω–¥–µ—Ä–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
    genders = [
        "–ú—É–∂—Å–∫–æ–π",
        "–ñ–µ–Ω—Å–∫–∏–π",
        "–ù–µ–±–∏–Ω–∞—Ä–Ω—ã–π",
        "–ì–µ–Ω–¥–µ—Ä—Ñ–ª—é–∏–¥",
        "–ê–≥–µ–Ω–¥–µ—Ä",
        "–ë–∏–≥–µ–Ω–¥–µ—Ä",
        "–ì–µ–Ω–¥–µ—Ä–∫–≤–∏—Ä",
        "–î–≤—É–¥—É—Ö (Two-Spirit)",
        "–ù–µ–π—Ç—Ä–æ–π—Å",
        "–î–µ–º–∏–≥—ë—Ä–ª",
        "–î–µ–º–∏–±–æ–π"
    ]

    male_endings = ['–π', '–Ω', '–ª', '—Ä', '–º', '–≤', '–≥', '–¥', '–∫', '—Ç', '–∏–π', '–∏–º', '–∞–Ω', '–æ–Ω']
    female_endings = ['–∞', '—è', '–Ω–∞', '–∏—è', '–ª–∞']
    neutral_endings = ['–∏', '—Å', '—å', '–æ', '–µ', '–µ–Ω', '–∏—Å']

    name = name.strip().lower()

    if not name:
        return random.choice(genders)

    # 30% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–±–∏–Ω–∞—Ä–Ω—ã–π/–¥—Ä—É–≥–æ–π –≥–µ–Ω–¥–µ—Ä
    if random.random() < 0.3:
        return random.choice(genders[2:])  # –ù–µ–±–∏–Ω–∞—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏—é
    if any(name.endswith(end) for end in female_endings):
        return "–ñ–µ–Ω—Å–∫–∏–π" if random.random() > 0.2 else random.choice(["–î–µ–º–∏–≥—ë—Ä–ª", "–ì–µ–Ω–¥–µ—Ä—Ñ–ª—é–∏–¥", "–ë–∏–≥–µ–Ω–¥–µ—Ä"])
    elif any(name.endswith(end) for end in male_endings):
        return "–ú—É–∂—Å–∫–æ–π" if random.random() > 0.2 else random.choice(["–î–µ–º–∏–±–æ–π", "–ì–µ–Ω–¥–µ—Ä—Ñ–ª—é–∏–¥", "–ë–∏–≥–µ–Ω–¥–µ—Ä"])
    elif any(name.endswith(end) for end in neutral_endings):
        return random.choice(["–ù–µ–±–∏–Ω–∞—Ä–Ω—ã–π", "–ê–≥–µ–Ω–¥–µ—Ä", "–ù–µ–π—Ç—Ä–æ–π—Å", "–ì–µ–Ω–¥–µ—Ä–∫–≤–∏—Ä"])
    else:
        return random.choice(genders)

def gender_detector():
    """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –≥–µ–Ω–¥–µ—Ä–∞"""
    print("\n=== üåà –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –≥–µ–Ω–¥–µ—Ä–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ ===")

    while True:
        name = input("\n–í–≤–µ–¥–∏—Ç–µ –∏–º—è (–∏–ª–∏ '–≤—ã—Ö–æ–¥' –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞): ")

        if name.lower() == '–≤—ã—Ö–æ–¥':
            break

        gender = guess_gender_by_name(name)

        # –î–æ–±–∞–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
        descriptions = {
            "–ú—É–∂—Å–∫–æ–π": "—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è –º—É–∂—Å–∫–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å",
            "–ñ–µ–Ω—Å–∫–∏–π": "—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è –∂–µ–Ω—Å–∫–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å",
            "–ù–µ–±–∏–Ω–∞—Ä–Ω—ã–π": "–∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –≤–Ω–µ –±–∏–Ω–∞—Ä–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º—É–∂—á–∏–Ω–∞/–∂–µ–Ω—â–∏–Ω–∞",
            "–ì–µ–Ω–¥–µ—Ä—Ñ–ª—é–∏–¥": "–≥–µ–Ω–¥–µ—Ä –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º",
            "–ê–≥–µ–Ω–¥–µ—Ä": "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–µ–Ω–¥–µ—Ä–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏",
            "–ë–∏–≥–µ–Ω–¥–µ—Ä": "–¥–≤–µ –≥–µ–Ω–¥–µ—Ä–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ",
            "–ì–µ–Ω–¥–µ—Ä–∫–≤–∏—Ä": "–∫–≤–∏—Ä-–∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –≤–Ω–µ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π",
            "–î–≤—É–¥—É—Ö (Two-Spirit)": "—Ç–µ—Ä–º–∏–Ω –∫–æ—Ä–µ–Ω–Ω—ã—Ö –∞–º–µ—Ä–∏–∫–∞–Ω—Ü–µ–≤, —Ç—Ä–µ—Ç–∏–π –≥–µ–Ω–¥–µ—Ä",
            "–ù–µ–π—Ç—Ä–æ–π—Å": "–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è –≥–µ–Ω–¥–µ—Ä–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å",
            "–î–µ–º–∏–≥—ë—Ä–ª": "—á–∞—Å—Ç–∏—á–Ω–æ –∂–µ–Ω—Å–∫–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å",
            "–î–µ–º–∏–±–æ–π": "—á–∞—Å—Ç–∏—á–Ω–æ –º—É–∂—Å–∫–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å"
        }

        description = descriptions.get(gender, "—É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å")
        print(f"‚ú® –ò–º—è: {name}")
        print(f"üè≥Ô∏è‚Äçüåà –ì–µ–Ω–¥–µ—Ä–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å: {gender}")
        print(f"üìù –û–ø–∏—Å–∞–Ω–∏–µ: {description}")

def calculator():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞"""
    print("=== –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä ===")
    print("1. –°–ª–æ–∂–µ–Ω–∏–µ (+)")
    print("2. –í—ã—á–∏—Ç–∞–Ω–∏–µ (-)")
    print("3. –£–º–Ω–æ–∂–µ–Ω–∏–µ (*)")
    print("4. –î–µ–ª–µ–Ω–∏–µ (/)")
    print("5. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –≥–µ–Ω–¥–µ—Ä–∞")
    print("6. –í—ã—Ö–æ–¥")

    while True:
        choice = input("\n–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—é (1-6): ")

        if choice == '6':
            print("–í—ã—Ö–æ–¥ –∏–∑ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞")
            break

        if choice == '5':
            gender_detector()
        elif choice in ['1', '2', '3', '4']:
            try:
                num1 = float(input("–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ: "))
                num2 = float(input("–í–≤–µ–¥–∏—Ç–µ –≤—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ: "))

                if choice == '1':
                    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {num1} + {num2} = {add(num1, num2)}")
                elif choice == '2':
                    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {num1} - {num2} = {subtract(num1, num2)}")
                elif choice == '3':
                    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {num1} * {num2} = {multiply(num1, num2)}")
                elif choice == '4':
                    result = divide(num1, num2)
                    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {num1} / {num2} = {result}")
            except ValueError:
                print("–û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ")
        else:
            print("–û—à–∏–±–∫–∞: –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—é –æ—Ç 1 –¥–æ 6")

if __name__ == "__main__":
    calculator()
